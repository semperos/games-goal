rs:{((*/x)#y){(-y)$x}/|1_x}; reset:{end::0; l::15; dir::"s"; newdir::""; brd::rs[(l;l);0]; walls::((3 0);(3 8);(1 4);(8 4);(6 7);(4 1)); allpos::,/(!l),'`(!l); snk::(2 0;1 0;0 0); frt::5 5}; reset""
dirs:!"n e s w"; kp:(!"Up Right Down Left")!dirs; odirs:dirs!2 rotate dirs; dirfns::dirs!({(x-1;y)};{(x;y+1)};{(x+1;y)};{(x;y-1)})
newfrt:{[snk]*1?allpos[&~allpos¿walls,snk]} 
plot:{brd::rs[(l;l);"🌴"]; {brd::.[brd;x;{"💣"}]}'walls; ?[end;rs[(l;l);"💥"];[{brd::.[brd;x;{"🩷"}]}'1_snk; brd::.[brd;*snk;{"🐲"}]; brd::.[brd;frt;{"😿"}]; brd]]}
coll:{[hd;snk]ouch:walls,1_snk; end::|/(|/ouch¿,hd;-1=&/sign hd;l=|/hd); end}
move:{[keyPress]ndir::kp keyPress; dir::?[ndir~odirs[dir];dir;ndir];dirfn:dirfns[dir];{brd::.[brd;x;{0}]}'snk;hd:dirfn.*snk;?[coll[hd;snk];:1;0];eats:hd~frt;tl:?[eats;snk;-1_snk];snk::(,hd),tl;frt::?[eats;newfrt[snk];frt]}
update:{[dt]?[end;:error"Game over";0]; ?[game.KeyPress;move game.KeyPress;0]}
draw:{say shell"clear";say'plot[brd];say "\n🐍 " + $#snk}
